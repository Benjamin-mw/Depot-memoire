---
title: "Untitled"
output: html_document
date: "2023-04-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(rpart)
library(rpart.plot)
library(sp)
library(CASdatasets)
```

```{r}
data(freMPL5)

set.seed(123) # fixer la graine pour la reproductibilité
train.index <- sample(1:nrow(freMPL5), size=0.7*nrow(freMPL5), replace=FALSE)
train.data <- freMPL5[train.index,]
test.data <- freMPL5[-train.index,]
```

```{r}

freMPL5.Tree <- rpart(ClaimAmount~ ., data=train.data, method="anova" , control=rpart.control(xval = 10, minbucket = 50,cp=0))
rpart.plot(freMPL5.Tree)


```


```{r}
#On utilise plotcp pour afficher la courbe du taux d'erreur relatif en fonction des cp, on choisi un cp qui minimise ce taux d'erreur pour une taille correcte
plotcp(freMPL5.Tree)
printcp(freMPL5.Tree)
```

```{r}
#étape d'élagage de l'arbre avec un cp qui minimise le taux d'erreur relatif tout en donnant un arbre de taille correcte
freMPL5.Tree.prune.Amount=prune(freMPL5.Tree.Amount,cp=1.1007e-03)
rpart.plot(freMPL5.Tree.prune.Amount)
```
